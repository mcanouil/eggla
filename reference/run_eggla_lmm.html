<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Perform EGG longitudinal analysis and derived areas under the curves and slopes. — run_eggla_lmm • eggla</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Perform EGG longitudinal analysis and derived areas under the curves and slopes. — run_eggla_lmm"><meta name="description" content="Perform Daymont's quality-control for BMI,
fit a cubic splines mixed model regression
with linear splines as random effect,
save model object, generates residuals figures fot model validity,
derived area under the curve and slopes for male and femal.
This function is a wrapper around egg_model(), egg_slopes() and egg_aucs()."><meta property="og:description" content="Perform Daymont's quality-control for BMI,
fit a cubic splines mixed model regression
with linear splines as random effect,
save model object, generates residuals figures fot model validity,
derived area under the curve and slopes for male and femal.
This function is a wrapper around egg_model(), egg_slopes() and egg_aucs()."><meta property="og:image" content="https://m.canouil.dev/eggla/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">eggla</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.0.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/eggla.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/models-diagnostics.html">Models Diagnostics</a></li>
    <li><a class="dropdown-item" href="../articles/model-selection.html">Model Selection</a></li>
    <li><a class="dropdown-item" href="../articles/run-cubic-splines.html">Run The Cubic Splines (Random Cubic/Linear Splines) Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/adiposity-peak-rebound.html">Adiposity Peak &amp; Adiposity Rebound Caracterisation</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mcanouil/eggla/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Perform EGG longitudinal analysis and derived areas under the curves and slopes.</h1>
      <small class="dont-index">Source: <a href="https://github.com/mcanouil/eggla/blob/v1.0.4/R/run_eggla_lmm.R" class="external-link"><code>R/run_eggla_lmm.R</code></a></small>
      <div class="d-none name"><code>run_eggla_lmm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Perform Daymont's quality-control for BMI,
fit a cubic splines mixed model regression
with linear splines as random effect,
save model object, generates residuals figures fot model validity,
derived area under the curve and slopes for male and femal.
This function is a wrapper around <code><a href="egg_model.html">egg_model()</a></code>, <code><a href="egg_slopes.html">egg_slopes()</a></code> and <code><a href="egg_aucs.html">egg_aucs()</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">run_eggla_lmm</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">id_variable</span>,</span>
<span>  <span class="va">age_days_variable</span>,</span>
<span>  <span class="va">age_years_variable</span>,</span>
<span>  <span class="va">weight_kilograms_variable</span>,</span>
<span>  <span class="va">height_centimetres_variable</span>,</span>
<span>  <span class="va">sex_variable</span>,</span>
<span>  <span class="va">covariates</span>,</span>
<span>  male_coded_zero <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  random_complexity <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  use_car1 <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">8</span>, <span class="fl">12</span><span class="op">)</span>,</span>
<span>  period <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">3.5</span>, <span class="fl">6.5</span>, <span class="fl">10</span>, <span class="fl">12</span>, <span class="fl">17</span><span class="op">)</span>,</span>
<span>  start <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>  end <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  step <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  filter <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  outlier_method <span class="op">=</span> <span class="st">"iqr"</span>,</span>
<span>  outlier_threshold <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>iqr <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>  outlier_exclude <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  parallel_n_chunks <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  working_directory <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  clean <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>Phenotypes data that inherits from <code>data.frame</code> class.</p></dd>


<dt id="arg-id-variable">id_variable<a class="anchor" aria-label="anchor" href="#arg-id-variable"></a></dt>
<dd><p>Name of the column where sample/individual IDs are stored.</p></dd>


<dt id="arg-age-days-variable">age_days_variable<a class="anchor" aria-label="anchor" href="#arg-age-days-variable"></a></dt>
<dd><p>Name of the column where age in days is stored.
<code>NULL</code> if age in days is not available.</p></dd>


<dt id="arg-age-years-variable">age_years_variable<a class="anchor" aria-label="anchor" href="#arg-age-years-variable"></a></dt>
<dd><p>Name of the column where age in years is stored.
<code>NULL</code> if age in years is not available.</p></dd>


<dt id="arg-weight-kilograms-variable">weight_kilograms_variable<a class="anchor" aria-label="anchor" href="#arg-weight-kilograms-variable"></a></dt>
<dd><p>Name of the column where weight in kilograms is stored.</p></dd>


<dt id="arg-height-centimetres-variable">height_centimetres_variable<a class="anchor" aria-label="anchor" href="#arg-height-centimetres-variable"></a></dt>
<dd><p>Name of the column where height in centimetres is stored.</p></dd>


<dt id="arg-sex-variable">sex_variable<a class="anchor" aria-label="anchor" href="#arg-sex-variable"></a></dt>
<dd><p>Name of the column where sex is stored.</p></dd>


<dt id="arg-covariates">covariates<a class="anchor" aria-label="anchor" href="#arg-covariates"></a></dt>
<dd><p>A vector of columns' names to be used as covariates.
<code>NULL</code> if there are no covariates to add.</p></dd>


<dt id="arg-male-coded-zero">male_coded_zero<a class="anchor" aria-label="anchor" href="#arg-male-coded-zero"></a></dt>
<dd><p>Is male coded "0" (and female coded "1")?</p></dd>


<dt id="arg-random-complexity">random_complexity<a class="anchor" aria-label="anchor" href="#arg-random-complexity"></a></dt>
<dd><p>A numeric (1-3) indicating the complexity of the random effect term.
Default, <code>"auto"</code> will try from the more complex to the less complex if no success.</p></dd>


<dt id="arg-use-car-">use_car1<a class="anchor" aria-label="anchor" href="#arg-use-car-"></a></dt>
<dd><p>A logical indicating whether to use continuous auto-correlation,
i.e., CAR(1) as correlation structure.</p></dd>


<dt id="arg-knots">knots<a class="anchor" aria-label="anchor" href="#arg-knots"></a></dt>
<dd><p>The knots defining the splines.</p></dd>


<dt id="arg-period">period<a class="anchor" aria-label="anchor" href="#arg-period"></a></dt>
<dd><p>The intervals knots on which slopes are to be computed.</p></dd>


<dt id="arg-start">start<a class="anchor" aria-label="anchor" href="#arg-start"></a></dt>
<dd><p>The start of the time window to compute AP and AR.</p></dd>


<dt id="arg-end">end<a class="anchor" aria-label="anchor" href="#arg-end"></a></dt>
<dd><p>The end of the time window to compute AP and AR.</p></dd>


<dt id="arg-step">step<a class="anchor" aria-label="anchor" href="#arg-step"></a></dt>
<dd><p>The step to increment the sequence.</p></dd>


<dt id="arg-filter">filter<a class="anchor" aria-label="anchor" href="#arg-filter"></a></dt>
<dd><p>A string following <code>data.table</code> syntax for filtering on <code>"i"</code>
(<em>i.e.</em>, row elements), <em>e.g.</em>, <code>filter = "source == 'A'"</code>.
Argument pass through <code><a href="compute_apar.html">compute_apar()</a></code> (see <code><a href="predict_bmi.html">predict_bmi()</a></code>).
Default is <code>NULL</code>.</p></dd>


<dt id="arg-outlier-method">outlier_method<a class="anchor" aria-label="anchor" href="#arg-outlier-method"></a></dt>
<dd><p>The outlier detection method(s). Default is <code>"iqr"</code>. Can be
<code>"cook"</code>, <code>"pareto"</code>, <code>"zscore"</code>, <code>"zscore_robust"</code>, <code>"iqr"</code>, <code>"ci"</code>, <code>"eti"</code>,
<code>"hdi"</code>, <code>"bci"</code>, <code>"mahalanobis"</code>, <code>"mahalanobis_robust"</code>, <code>"mcd"</code>, <code>"ics"</code>,
<code>"optics"</code> or <code>"lof"</code>.
See <code><a href="https://easystats.github.io/performance/reference/check_outliers.html" class="external-link">performance::check_outliers()</a></code> <a href="https://easystats.github.io/performance/reference/check_outliers.html" class="external-link">https://easystats.github.io/performance/reference/check_outliers.html</a> for details.</p></dd>


<dt id="arg-outlier-threshold">outlier_threshold<a class="anchor" aria-label="anchor" href="#arg-outlier-threshold"></a></dt>
<dd><p>A list containing the threshold values for each method (<em>e.g.</em>,
<code>list('mahalanobis' = 7, 'cook' = 1)</code>), above which an observation is
considered as outlier. If <code>NULL</code>, default values will be used (see
'Details'). If a numeric value is given, it will be used as the threshold
for any of the method run.
See <code><a href="https://easystats.github.io/performance/reference/check_outliers.html" class="external-link">performance::check_outliers()</a></code> <a href="https://easystats.github.io/performance/reference/check_outliers.html" class="external-link">https://easystats.github.io/performance/reference/check_outliers.html</a> for details.</p></dd>


<dt id="arg-outlier-exclude">outlier_exclude<a class="anchor" aria-label="anchor" href="#arg-outlier-exclude"></a></dt>
<dd><p>Whether or not the values/individuals flagged as being outliers should be excluded.
Default is <code>TRUE</code>.</p></dd>


<dt id="arg-parallel">parallel<a class="anchor" aria-label="anchor" href="#arg-parallel"></a></dt>
<dd><p>Determines if <code><a href="https://rdrr.io/pkg/growthcleanr/man/cleangrowth.html" class="external-link">growthcleanr::cleangrowth()</a></code> function shoud be run in parallel. Defaults to <code>FALSE</code>.</p></dd>


<dt id="arg-parallel-n-chunks">parallel_n_chunks<a class="anchor" aria-label="anchor" href="#arg-parallel-n-chunks"></a></dt>
<dd><p>Specify the number of batches (in <code><a href="https://rdrr.io/pkg/growthcleanr/man/cleangrowth.html" class="external-link">growthcleanr::cleangrowth()</a></code>) to run in parallel.
Only applies if parallel is set to TRUE.
Defaults to the number of workers returned by the getDoParWorkers function in the foreach package.</p></dd>


<dt id="arg-working-directory">working_directory<a class="anchor" aria-label="anchor" href="#arg-working-directory"></a></dt>
<dd><p>Directory in which computation will occur and where output files will be saved.</p></dd>


<dt id="arg-quiet">quiet<a class="anchor" aria-label="anchor" href="#arg-quiet"></a></dt>
<dd><p>A logical indicating whether to suppress the output.</p></dd>


<dt id="arg-clean">clean<a class="anchor" aria-label="anchor" href="#arg-clean"></a></dt>
<dd><p>A logical indicating whether to clean <code>working_directory</code> once the archives are created.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Path to zip archives.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"bmigrowth"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/fwrite.html" class="external-link">fwrite</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">bmigrowth</span>,</span></span>
<span class="r-in"><span>    file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"bmigrowth.csv"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">run_eggla_lmm</span><span class="op">(</span></span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/fread.html" class="external-link">fread</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"bmigrowth.csv"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    id_variable <span class="op">=</span> <span class="st">"ID"</span>,</span></span>
<span class="r-in"><span>    age_days_variable <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>    age_years_variable <span class="op">=</span> <span class="st">"age"</span>,</span></span>
<span class="r-in"><span>    weight_kilograms_variable <span class="op">=</span> <span class="st">"weight"</span>,</span></span>
<span class="r-in"><span>    height_centimetres_variable <span class="op">=</span> <span class="st">"height"</span>,</span></span>
<span class="r-in"><span>    sex_variable <span class="op">=</span> <span class="st">"sex"</span>,</span></span>
<span class="r-in"><span>    covariates <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>    random_complexity <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    working_directory <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://mickael.canouil.fr" class="external-link">Mickaël Canouil</a>, Nicole Warrington, Kimberley Burrows, Anni Heiskala.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

